<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Qu·∫£n L√Ω Chi Ti√™u</title>
    <link rel="stylesheet" href="../src/styles/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="user-profile">
                <img src="https://via.placeholder.com/60" alt="Avatar" class="avatar">
                <div class="user-name" id="user-name">Loading...</div>
            </div>
            <nav class="navigation">
                <button class="nav-button active">üìä T·ªïng quan</button>
                <button class="nav-button">üí∞ Thu nh·∫≠p</button>
                <button class="nav-button">üõí Chi ti√™u</button>
                <button class="nav-button">üìà B√°o c√°o</button>
            </nav>
            <button class="nav-button logout-button" onclick="logout()">üö™ ƒêƒÉng xu·∫•t</button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="main-header">
                <h1>üè† QU·∫¢N L√ù CHI TI√äU C√Å NH√ÇN</h1>
            </div>

            <!-- Summary Cards -->
            <div class="summary-cards" id="summary-cards">
                <!-- Categories s·∫Ω ƒë∆∞·ª£c load t·ª´ API -->
            </div>

            <!-- Statistics -->
            <div class="statistics">
                <!-- EXPENSE TABLE SECTION -->
                <div class="stats-section">
                    <div class="stats-header">
                        <h2>üìä TH·ªêNG K√ä CHI PH√ç</h2>

                        <!-- Filter buttons -->
                        <div class="filter-container">
                            <button class="filter-button active" onclick="setExpenseFilter('day')">NG√ÄY</button>
                            <button class="filter-button" onclick="setExpenseFilter('week')">TU·∫¶N</button>
                            <button class="filter-button" onclick="setExpenseFilter('month')">TH√ÅNG</button>
                        </div>
                    </div>

                    <!-- Pie Chart -->
                    <div class="chart-section">
                        <div class="chart-container">
                            <canvas id="expense-pie-chart" width="400" height="400"></canvas>
                        </div>
                        <div class="chart-summary">
                            <h4>Chi ti√™u t·ªïng: <span id="total-expense-amount">0‚Ç´</span></h4>
                            <div id="chart-legend" class="chart-legend"></div>
                        </div>
                    </div>

                    <!-- Expense Table -->
                    <div class="table-container">
                        <table id="expense-table">
                            <thead>
                                <tr>
                                    <th>Lo·∫°i</th>
                                    <th>Ng√†y</th>
                                    <th>Chi</th>
                                    <th>M√¥ t·∫£</th>
                                    <th>Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="5" style="text-align: center; color: #666; padding: 20px;">
                                        Nh·∫•n v√†o Ng√†y/Tu·∫ßn/Th√°ng ƒë·ªÉ xem.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div id="pagination-info" class="pagination-info"></div>
                    </div>
                </div>

                <!-- Update Expense Modal -->
                <div id="update-expense-overlay" class="custom-alert-overlay">
                    <div class="custom-alert-box">
                        <h3 id="update-expense-modal-title">C·∫≠p nh·∫≠t chi ti√™u</h3>
                        <form id="update-expense-form">
                            <input type="hidden" id="update-expense-id">

                            <label for="update-expense-category">Danh m·ª•c m·ªõi (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi):</label>
                            <input type="text" id="update-expense-category" placeholder="T√™n danh m·ª•c">

                            <label for="update-expense-amount">S·ªë ti·ªÅn m·ªõi (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi):</label>
                            <input type="number" id="update-expense-amount" step="0.01" min="0" placeholder="0">

                            <label for="update-expense-description">M√¥ t·∫£ m·ªõi (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi):</label>
                            <input id="update-expense-description" placeholder="M√¥ t·∫£ chi ti√™u"></input>

                            <div class="alert-actions">
                                <button type="button" class="alert-btn btn-cancel"
                                    onclick="closeCustomAlert('update-expense-overlay')">H·ªßy</button>
                                <button type="submit" class="alert-btn btn-confirm">C·∫≠p nh·∫≠t</button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>

            <!-- Modal: T·∫°o Category -->
            <div id="create-category-overlay" class="custom-alert-overlay">
                <div class="custom-alert-box">
                    <h3>Th√™m danh m·ª•c m·ªõi</h3>
                    <form id="create-category-form">
                        <input type="text" id="new-category-name" placeholder="Nh·∫≠p t√™n danh m·ª•c" required>
                        <input type="number" id="new-category-budget" placeholder="Ng√¢n s√°ch (VNƒê)" required min="0"
                            step="1000">
                        <div class="alert-buttons">
                            <button type="button" class="alert-btn btn-cancel"
                                onclick="closeCustomAlert('create-category-overlay')">H·ªßy</button>
                            <button type="submit" class="alert-btn btn-confirm">T·∫°o</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal: C·∫≠p nh·∫≠t Category -->
            <div id="update-category-overlay" class="custom-alert-overlay">
                <div class="custom-alert-box">
                    <h3>C·∫≠p nh·∫≠t danh m·ª•c</h3>
                    <form id="update-category-form">
                        <input type="hidden" id="update-category-id">
                        <input type="text" id="update-category-name" placeholder="T√™n m·ª•c m·ªõi (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi)">
                        <input type="number" id="update-category-budget" placeholder="Ng√¢n s√°ch (VNƒê)" min="0"
                            step="1000">
                        <div class="alert-buttons">
                            <button type="button" class="alert-btn btn-cancel"
                                onclick="closeCustomAlert('update-category-overlay')">H·ªßy</button>
                            <button type="submit" class="alert-btn btn-confirm">C·∫≠p nh·∫≠t</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal: Chi ti√™u -->
            <div id="expense-overlay" class="custom-alert-overlay">
                <div class="custom-alert-box">
                    <h3 id="expense-modal-title">Th√™m chi ti√™u</h3>
                    <form id="expense-form">
                        <input type="hidden" id="expense-category-id">
                        <input type="text" id="expense-amount" placeholder="S·ªë ti·ªÅn (VNƒê)" required min="1" step="1000">
                        <input type="text" id="expense-description" placeholder="M√¥ t·∫£ chi ti√™u...">
                        <div class="alert-buttons">
                            <button type="button" class="alert-btn btn-cancel"
                                onclick="closeCustomAlert('expense-overlay')">H·ªßy</button>
                            <button type="submit" class="alert-btn btn-confirm">Th√™m chi ti√™u</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Custom Alert/Notification -->
            <div id="custom-alert-overlay" class="custom-alert-overlay">
                <div class="custom-alert-box">
                    <h3>Th√¥ng b√°o</h3>
                    <p id="alert-message">N·ªôi dung th√¥ng b√°o ·ªü ƒë√¢y.</p>
                    <div class="alert-buttons">
                        <button id="alert-ok-btn" class="alert-btn btn-confirm">OK</button>
                    </div>
                </div>
            </div>

            <!-- Scripts -->
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script src="../src/scripts/utils/constants.js"></script>
            <script src="../src/scripts/api/api-service.js"></script>
            <script src="../src/scripts/api/category-api.js"></script>
            <script src="../src/scripts/api/expense-api.js"></script>
            <script src="../src/scripts/utils/modal-manager.js"></script>
            <script src="../src/scripts/utils/format-utils.js"></script>
            <script src="../src/scripts/components/chart-manager.js"></script>
            <script src="../src/scripts/components/expense-manager.js"></script>
            <script src="../src/scripts/components/category-manager.js"></script>
            <script src="../src/scripts/utils/auth-utils.js"></script>
</body>

</html>